     
<!DOCTYPE html>
<html lang="en"><head><meta charset="utf-8"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><title>Quiz Review</title><style>:root{--g:linear-gradient(135deg,#60a5fa,#a78bfa 40%,#f472b6);--bd:#334155;--bg:#0b1220}body{font-family:Arial,Helvetica,sans-serif;max-width:900px;margin:0 auto;padding:1.5rem;background:#0f172a;color:#e2e8f0}h1{text-align:center;position:relative;z-index:2;margin:0 0 .25rem;font-size:2rem;background:var(--g);-webkit-background-clip:text;background-clip:text;color:transparent;text-shadow:0 0 24px rgba(96,165,250,.25),0 0 36px rgba(167,139,250,.25)}#quiz-card{position:relative;background:#1f2937;border:2px solid #374151;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,.6);padding:2rem 2rem 90px}.question-text{font-size:1.3rem;font-weight:800;margin-bottom:1rem;color:#f1f5f9}.choice{display:block;width:100%;margin:.35rem 0;padding:.7rem 1rem;border:2px solid #475569;border-radius:10px;background:#334155;color:#f8fafc;cursor:pointer;transition:transform .05s ease,background .2s,border .2s}.choice:hover{background:#1e293b;transform:translateY(-1px)}.choice.correct{border-color:#22c55e;background:#14532d}.choice.incorrect{border-color:#ef4444;background:#7f1d1d}#next-btn,#reset-btn,#prev-btn,#open-tab-btn{padding:.8rem 1.25rem;font-size:1rem;border:none;border-radius:10px;cursor:pointer}#explanation{margin-top:1rem;padding:1rem;border-radius:10px;background:var(--bg);border:1px solid var(--bd);display:none;line-height:1.45}#additional{margin-top:.75rem;padding:1rem;border-radius:10px;background:#111827;border:1px dashed var(--bd);font-size:.98rem;color:#d1d5db;display:none;line-height:1.45}#instr-btn{position:fixed;left:16px;bottom:64px;padding:.8rem 1.25rem;font-size:1rem;border:none;border-radius:10px;background:var(--bg);border:1px solid var(--bd);background-image:var(--g);-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;color:transparent;cursor:pointer}#instr-panel{position:fixed;left:16px;bottom:140px;min-width:320px;max-width:420px;background:var(--bg);border:1px solid var(--bd);border-radius:12px;box-shadow:0 12px 28px rgba(0,0,0,.55);padding:.6rem;display:none;z-index:10006}#instr-panel textarea{width:100%;min-height:140px;background:#0f172a;color:#e5e7eb;border:1px solid var(--bd);border-radius:8px;padding:.5rem;font-family:ui-monospace,Menlo,monospace;font-size:.9rem}#instr-copy{margin-top:.5rem;padding:.45rem .7rem;border:none;border-radius:10px;background:#2563eb;color:#fff;cursor:pointer}#next-btn{position:absolute;right:12px;bottom:12px;background-color:var(--bg);border:1px solid var(--bd);background-image:var(--g);-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;color:transparent}#prev-btn{position:absolute;left:12px;bottom:12px;background-color:var(--bg);border:1px solid var(--bd);background-image:var(--g);-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;color:transparent}#prev-btn:before{content:'← ';font-weight:700}#next-btn:after{content:' →';font-weight:700}#reset-btn{position:fixed;left:16px;bottom:16px;background:var(--bg);border:1px solid var(--bd);background-image:var(--g);-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;color:transparent}#open-tab-btn{position:fixed;right:16px;bottom:16px;background:var(--bg);border:1px solid var(--bd);background-image:var(--g);-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;color:transparent;box-shadow:0 4px 12px rgba(0,0,0,.35)}#save-btn{position:absolute;left:50%;bottom:12px;transform:translateX(-50%);background:#f59e0b;color:#111827;z-index:10005}#save-btn.saved{background:#16a34a;color:#fff}#review-menu-btn{position:absolute;left:calc(100% + 8px);top:-36px;padding:.45rem .7rem;font-size:.95rem;border:1px solid var(--bd);border-radius:10px;background:var(--bg);background-image:var(--g);-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;color:transparent;cursor:pointer}#review-menu-btn:hover{background:#1f2937}#review-menu{position:absolute;top:56px;left:calc(100% + 8px);min-width:280px;max-width:360px;max-height:50vh;overflow:auto;background:var(--bg);border:1px solid var(--bd);border-radius:12px;box-shadow:0 8px 24px rgba(0,0,0,.5);padding:.5rem;display:none}#review-menu h3{margin:.25rem .5rem .5rem;font-size:1rem;color:#e5e7eb}#review-menu ul{list-style:none;margin:0;padding:0}#review-menu li{display:flex;align-items:center;gap:.5rem;padding:.4rem .5rem;border-radius:8px}#review-menu li:hover{background:#111827}.rev-jump{flex:1;text-align:left;background:transparent;border:none;color:#d1d5db;cursor:pointer}.rev-remove{background:#ef4444;border:none;color:#fff;border-radius:8px;padding:.2rem .45rem;cursor:pointer}#import-btn{position:absolute;top:28px;left:calc(100% + 8px);padding:.45rem .7rem;font-size:.95rem;border:1px solid var(--bd);border-radius:10px;background:var(--bg);background-image:var(--g);-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;color:transparent;cursor:pointer;box-shadow:0 4px 12px rgba(0,0,0,.35);z-index:10005}#import-btn:hover{background:#334155}#import-menu{position:absolute;top:56px;left:calc(100% + 8px);min-width:320px;max-width:420px;max-height:60vh;overflow:auto;background:var(--bg);border:1px solid var(--bd);border-radius:12px;box-shadow:0 12px 28px rgba(0,0,0,.55);padding:.6rem;display:none;z-index:10006}#import-menu h3{margin:.25rem .5rem .5rem;font-size:1rem;color:#e5e7eb}#import-menu textarea{width:100%;min-height:160px;background:#0f172a;color:#e5e7eb;border:1px solid var(--bd);border-radius:8px;padding:.5rem;font-family:ui-monospace,Menlo,monospace;font-size:.9rem}#search-wrap{margin-bottom:.75rem;position:relative}#search-input{width:100%;padding:.6rem .75rem;border-radius:10px;border:1px solid var(--bd);background:var(--bg);color:#e5e7f0}#search-results{position:absolute;top:100%;left:0;right:0;background:var(--bg);border:1px solid var(--bd);border-top:none;max-height:40vh;overflow:auto;border-radius:0 0 10px 10px;display:none;z-index:10007;list-style:none;margin:0;padding:0}#search-results li{padding:.5rem .75rem;cursor:pointer;border-top:1px solid #1f2937}#search-results li:hover{background:#111827}#jump-select{position:absolute;top:12px;left:-8px;transform:translateX(-100%);margin-left:0;padding:.2rem .45rem;border:1px solid var(--bd);border-radius:8px;background:var(--bg);color:#e5e7f0;font-size:.95rem}#jump-select:focus{outline:none;box-shadow:0 0 0 2px rgba(37,99,235,.35)}.qhead{white-space:nowrap}.choice .label{margin-right:.5rem;font-weight:700;opacity:.9}
/* Buttons styled with title gradient */
#viewer-toggle-btn,#arrange-btn,#reset-layout-btn{
  margin:.4rem .4rem 0 0;display:inline-flex;align-items:center;gap:.5rem;
  padding:.45rem .8rem;border-radius:12px;border:1px solid rgba(255,255,255,.22);
  background:rgba(255,255,255,.06);backdrop-filter:blur(10px);
  font-weight:800;letter-spacing:.01em;background-image:var(--g);
  -webkit-background-clip:text;background-clip:text;color:transparent;
  text-shadow:0 0 18px rgba(96,165,250,.25);cursor:pointer
}
/* Layout and gap (>= 1.25in) */
#work-area{display:grid;grid-template-columns:1fr;column-gap:28px;align-items:start}
#work-area.viewer-open{grid-template-columns:minmax(0,1fr) minmax(420px,40%);column-gap:1.25in}
#pdf-pane{display:none;background:#111827;border:2px solid #374151;border-radius:14px;box-shadow:0 4px 14px rgba(0,0,0,.35);padding:.75rem}
#work-area.viewer-open #pdf-pane{display:block}
#pdf-title{margin:.25rem 0 .5rem;font-weight:800;letter-spacing:.01em;background-image:var(--g);-webkit-background-clip:text;background-clip:text;color:transparent}
#pdf-iframe{width:100%;height:72vh;border:0;background:#0b1220}
/* Toggle + list */
#resources-toggle{margin:.65rem 0 .25rem;display:block}
#resources-toggle > summary{
  cursor:pointer;user-select:none;display:inline-flex;align-items:center;gap:.5rem;
  padding:.45rem .75rem;border-radius:12px;border:1px solid rgba(255,255,255,.22);
  background:rgba(255,255,255,.06);backdrop-filter:blur(10px);
  font-weight:800;letter-spacing:.01em;background-image:var(--g);
  -webkit-background-clip:text;background-clip:text;color:transparent;
  text-shadow:0 0 18px rgba(96,165,250,.25);
}
#resources-panel{margin-top:.5rem;background:#1f2937;border:2px solid #374151;border-radius:14px;box-shadow:0 4px 12px rgba(0,0,0,.35);padding:.75rem}
#resources-list{display:flex;flex-direction:column;gap:.5rem;list-style:none;margin:0;padding:0}
.resources-link{display:flex;align-items:center;justify-content:space-between;gap:.75rem;text-decoration:none;border:1px solid #475569;background:#334155;border-radius:10px;padding:.55rem .75rem;color:#f8fafc;transition:transform .05s ease,background .2s,border .2s}
.resources-link:hover{background:#1e293b;transform:translateY(-1px)}
.resources-title{font-weight:700;letter-spacing:.01em}.resources-meta{opacity:.8;font-size:.9rem}
 
/* Arrange mode */
#work-area.viewer-open #quiz-card,#work-area.viewer-open #pdf-pane{resize:horizontal;overflow:auto}
body.arrange-mode #quiz-card,body.arrange-mode #pdf-pane{position:fixed;z-index:999;cursor:move;resize:both;overflow:auto;box-shadow:0 10px 30px rgba(0,0,0,.45)}
.drag-handle{position:absolute;top:6px;left:6px;font-size:.75rem;background:rgba(0,0,0,.45);color:#fff;padding:.2rem .45rem;border-radius:6px;display:none;user-select:none}
body.arrange-mode .drag-handle{display:block}
</style></head><body><h1>Quiz Review</h1><div id="work-area"><div id="quiz-card"><div class="drag-handle">Drag</div><button id="review-menu-btn">Saved (0)</button><div id="review-menu"><h3>Saved Questions</h3><ul id="review-list"></ul></div><button id="import-btn" title="Import questions">Import</button><div id="import-menu"><h3>Import Questions</h3><input accept=".json" id="import-json-file" style="width:100%;margin:.25rem 0 .35rem" type="file"/><button id="import-load-json" style="width:100%;margin:0 0 .5rem">Load 100Q JSON</button><textarea id="import-ta" placeholder="Paste JSON array of question objects here"></textarea><div class="rev-meta" id="import-status" style="margin-top:.25rem"></div></div><details id="resources-toggle"><summary>Lecture PDFs</summary><div id="resources-panel"><h3>Open a lecture PDF</h3><ul id="resources-list">
  <li><a class="resources-link" data-view="Lecture 1 Introduction to Histology and the Cell.pdf" href="#">
    <span class="resources-title">Lecture 1 — Introduction to Histology and the Cell</span>
    <span class="resources-meta">PDF</span>
  </a></li>
  <li><a class="resources-link" data-view="Lecture 2 Cell Cytoplasm and Organells.pdf" href="#">
    <span class="resources-title">Lecture 2 — Cell Cytoplasm and Organelles</span>
    <span class="resources-meta">PDF</span>
  </a></li>
  <li><a class="resources-link" data-view="Lecture 3 Cell Nucleus and Tissues.pdf" href="#">
    <span class="resources-title">Lecture 3 — Cell Nucleus and Tissues</span>
    <span class="resources-meta">PDF</span>
  </a></li>
  <li><a class="resources-link" data-view="Lecture 5 Connective Tissue I and II.pdf" href="#">
    <span class="resources-title">Lecture 5 — Connective Tissue I and II</span>
    <span class="resources-meta">PDF</span>
  </a></li>
  <li><a class="resources-link" data-view="Lecture 6 Cartilage (1).pdf" href="#">
    <span class="resources-title">Lecture 6 — Cartilage</span>
    <span class="resources-meta">PDF</span>
  </a></li>
  <li><a class="resources-link" data-view="Lecture 7 Blood I and II.pdf" href="#">
    <span class="resources-title">Lecture 7 — Blood I & II</span>
    <span class="resources-meta">PDF</span>
  </a></li>
  <li><a class="resources-link" data-view="Lectures 4 and 5 Epithelium part 1.pdf" href="#">
    <span class="resources-title">Lectures 4 & 5 — Epithelium Part 1</span>
    <span class="resources-meta">PDF</span>
  </a></li>
  <li><a class="resources-link" data-view="Lectures 4 and 5 Epithelium Part 2.pdf" href="#">
    <span class="resources-title">Lectures 4 & 5 — Epithelium Part 2</span>
    <span class="resources-meta">PDF</span>
  </a></li>
</ul></div></details><button id="viewer-toggle-btn" type="button">Show Lecture Viewer</button><button id="reset-layout-btn" type="button">Reset Positions</button><div id="search-wrap"><input id="search-input" placeholder="Search questions (title, choices, explanation)" type="text"/><ul id="search-results"></ul></div><div class="question-text" id="question"></div><div id="choices"></div><div id="explanation"></div><div id="additional"></div><button id="prev-btn" style="display:none">Previous</button><button id="save-btn" title="Save this question">☆ Save</button><div><button id="next-btn" style="display:none">Next Question</button><button id="reset-btn">Reset Progress</button></div></div><div id="pdf-pane"><div class="drag-handle">Drag</div><div id="pdf-title">Lecture Viewer</div><iframe id="pdf-iframe" src="about:blank" title="PDF Viewer"></iframe></div></div><button id="instr-btn" title="Copy-paste prompt">Instructions</button><div id="instr-panel"><textarea id="instr-ta" readonly=""></textarea><button id="instr-copy">Copy</button></div><button id="open-tab-btn">Open in New Tab</button><script>"use strict";const questions=[{q:"Primary function of mitochondria?",c:["ATP production by oxidative phosphorylation","Protein glycosylation","Lipid droplet storage","Detoxification of xenobiotics"],a:0,e:"The lecture states that mitochondria produce ATP by oxidative phosphorylation.",add:"Mitochondria are dynamic—changing shape, moving, and dividing.",w:["","Golgi/ER complete most glycosylation steps.","Neutral lipids typically store in adipocytes; mitochondria are not storage vacuoles.","Most detox occurs in smooth ER and peroxisomes, not mitochondria."]},{q:"Mitochondria are bounded by a double membrane; the inner membrane forms infoldings called:",c:["cisternae","thylakoids","grana","laminae"],a:0,e:"Inner mitochondrial membrane forms infoldings called cisternae in these slides, increasing surface area.",add:"Two compartments are created: intermembrane space and matrix.",w:["","These are chloroplast structures.","Also a chloroplast term.","Refers to nuclear lamina, not mitochondrial folds."]},{q:"The two mitochondrial compartments created by the membranes are:",c:["Intermembrane space and matrix","Cytosol and stroma","Periplasm and lumen","Nuclear space and cisternae"],a:0,e:"Outer and inner membranes create an intermembrane space and the matrix.",add:"The matrix contains proteins, RNA, DNA, and may have electron-dense Ca/Mg granules.",w:["","Those are chloroplast terms.","Periplasm is a bacterial term; lumen refers to ER/Golgi.","Mixes nuclear and mitochondrial terminology incorrectly."]},{q:"Ribosomes are composed of:",c:["rRNA (4 types) and ~80 proteins in two subunits","A single rRNA and a lipid monolayer","DNA and histones","Only proteins without RNA"],a:0,e:"Slides specify four types of rRNA and nearly eighty proteins forming two subunits; intensely basophilic.",add:"rRNA for both subunits is synthesized in the nucleolus.",w:["","Ribosomes are not lipid-enclosed.","DNA/histones describe chromatin.","Ribosomes are ribonucleoprotein particles."]},{q:"Polyribosomes are:",c:["Clusters of ribosomes held on a single mRNA","Ribosomes bound together by tRNA","Ribosomes stored in the Golgi","Inactive ribosomal subunits"],a:0,e:"Individual ribosomes are held together by a strand of mRNA, translating one message in parallel.",add:"This boosts throughput of protein synthesis from one transcript.",w:["","tRNA transfers amino acids but does not link ribosomes.","Golgi does not store ribosomes.","Polyribosomes are active, not inactive."]},{q:"The ER exists as:",c:["Smooth and rough forms that are continuous","Only rough stacks separated from smooth tubules","Three discrete forms with no continuity","Vesicles only"],a:0,e:"ER occurs as flat sheets and rounded tubules; smooth and rough are continuous with one another.",add:"Rough ER is continuous with the outer nuclear membrane.",w:["","Slides emphasize continuity between smooth and rough.","Only two forms are listed, not three.","Vesicles bud from ER/Golgi but are not the ER itself."]},{q:"Which is listed as a function of ER?",c:["Initial glycosylation of glycoproteins","ATP generation via TCA cycle","DNA replication","Lipid droplet catabolism"],a:0,e:"Functions include initial glycosylation, lipid synthesis, limited proteolysis of signal sequences, and more.",add:"Other ER functions: assemble multichain proteins; modify endogenous/exogenous compounds.",w:["","TCA enzymes are in the mitochondrial matrix.","Occurs in nucleus, not ER.","Not highlighted as an ER function here."]},{q:"Cells rich in rough ER are typically:",c:["Protein-secreting cells (e.g., pancreatic acinar, salivary serous, plasma cells)","Adipocytes storing triglyceride","Osteoclasts resorbing bone","Erythrocytes"],a:0,e:"Rough ER is prominent in protein-secreting cells such as pancreatic acinar, salivary serous, and plasma cells.",add:"Polyribosomes give RER a basophilic, granular appearance.",w:["","Adipocytes emphasize lipid storage, not abundant RER.","Osteoclasts are secretory but not classic RER exemplars in the slide.","Mature RBCs lack ER."]},{q:"During cotranslational targeting, the signal sequence binds:",c:["Signal recognition particle (SRP)","DNA polymerase","Clathrin","Dynein"],a:0,e:"SRP (a polypeptide/RNA complex) binds the N-terminal signal sequence and pauses elongation.",add:"The SRP–ribosome–nascent chain then docks to a receptor (docking protein) in the RER membrane.",w:["","Unrelated to translation targeting.","Clathrin coats vesicles downstream, not the ribosome.","A microtubule motor, not involved in SRP targeting."]},{q:"The SRP–ribosome complex binds a receptor on the RER commonly called the:",c:["Docking protein","Integrin","Perforin","Annexin"],a:0,e:"Slides name the receptor a ‘docking protein’ on the rough ER membrane.",add:"After docking, SRP is released and translation resumes through the translocation machinery.",w:["","Integrins are adhesion receptors.","Perforin is a cytolytic protein from immune cells.","Annexins bind membranes but are not the SRP receptor."]},{q:"Ribophorins I and II:",c:["Integral RER proteins that may form hydrophilic channels for nascent proteins","Mitochondrial matrix chaperones","Nuclear pore ring proteins","Golgi matrix scaffolds only"],a:0,e:"Rough ER contains integral membrane proteins ribophorin I/II which may form hydrophilic channels for passage into the lumen.",add:"Once inside, the signal sequence is removed by signal peptidase on the luminal side.",w:["","Not localized to mitochondria in this context.","Not nuclear pore components.","Ribophorins are RER, not Golgi, proteins."]},{q:"The enzyme that removes the signal peptide of a nascent protein in the RER is:",c:["Signal peptidase (luminal side)","Topoisomerase","Peptidyl-tRNA hydrolase","Catalase"],a:0,e:"Signal peptidase on the inner (luminal) surface of RER cleaves the signal sequence.",add:"Translation continues with concurrent structural modifications.",w:["","DNA topology enzyme (nuclear).","Releases peptides from tRNA at termination, not signal cleavage.","Peroxisomal enzyme for H2O2 breakdown."]},{q:"Smooth ER is characterized by:",c:["Interconnected haphazard tubules lacking surface ribosomes","Stacks of flattened sacs coated with ribosomes","Dense granules of rRNA","A double membrane with cristae"],a:0,e:"Smooth ER has numerous interconnected tubules without bound ribosomes; many cells have only small amounts.",add:"In muscle, smooth ER is called sarcoplasmic reticulum and associates with contraction.",w:["","That describes rough ER.","Describes nucleoli/ribosomes, not SER membranes.","Cristae (cisternae here) describe mitochondria."]},{q:"Which is a listed function of smooth ER?",c:["Detoxification and steroid synthesis","mRNA splicing","Oxidative phosphorylation","DNA replication licensing"],a:0,e:"Slides highlight fatty acid/phospholipid synthesis, detoxification (e.g., liver), and steroid synthesis; in muscle it is sarcoplasmic reticulum.",add:"Steroid-secreting cells are packed with SER.",w:["","Nuclear process.","Mitochondrial function.","Nuclear licensing, not SER."]},{q:"Golgi structure is best described as:",c:["Curved stack of cisternae with peripheral vesicles and vacuoles","Random tubules without polarity","Ribosome-coated sacs","A single flattened sac without vesicles"],a:0,e:"The Golgi is a curved stack of cisternae surrounded by vesicles; large vacuoles are present on one side.",add:"Polarity: forming convex cis face near RER; maturing concave trans face.",w:["","Golgi has clear polarity.","Ribosomes are on RER, not Golgi.","Multiple stacks and vesicles are typical."]},{q:"Which statement about Golgi polarity is correct?",c:["Cis face = forming/convex near RER; Trans face = maturing/concave with condensing vacuoles","Both faces are identical in structure and function","Trans face lies nearest the RER","Condensing vacuoles arise from the cis face"],a:0,e:"Forming (cis) face is convex and near RER; maturing (trans) face is concave; condensing vacuoles bud from trans.",add:"Condensing vacuoles deliver cargo to secretory granules and plasma membrane.",w:["","Slides explicitly describe polarity.","Opposite of slide.","Opposite of slide."]},{q:"Primary function of the Golgi listed in these slides:",c:["Complete chemical modifications and sort proteins to destinations","Synthesize rRNA subunits","Generate ATP via TCA cycle","Degrade H2O2 via catalase"],a:0,e:"Golgi completes modifications of ER-made proteins and determines their destination (PM, secretion, lysosomes, or retained in ER).",add:"Plasma membrane proteins move RER → Golgi → plasma membrane via transport vesicles.",w:["","Nucleolar job.","Mitochondrial job.","Peroxisomal job."]},{q:"Lysosomes are described as:",c:["Single-membrane organelles with hydrolytic enzymes active at acidic pH","Double-membrane organelles with DNA","Protein synthesis granules","Neutral-pH peroxidation sites"],a:0,e:"Slides: spherical, single-membrane organelles with many acid hydrolases; acidic pH; intracellular digestion & turnover.",add:"Enzymes synthesized in RER and modified/packaged in Golgi as lysosomes.",w:["","Not part of lysosome definition here.","Ribosomes synthesize proteins; lysosomes digest.","Peroxisomes handle H2O2 detox, not lysosomes."]},{q:"Lysosomal enzymes originate where before packaging as lysosomes?",c:["Synthesized in RER, modified in Golgi","Synthesized in mitochondria, sorted by peroxisomes","Made in cytosol and imported into nucleus","Synthesized on free ribosomes then secreted directly"],a:0,e:"Enzymes are synthesized in rough ER and then sent to Golgi where they are modified and packaged as lysosomes.",add:"Acid hydrolases require acidic lumen; primary vs secondary states reflect activity.",w:["","Not per lecture.","Nuclear import is unrelated here.","They’re routed via Golgi, not secreted directly."]},{q:"Primary vs secondary lysosomes:",c:["Primary: uniform, not yet digesting; Secondary: heterogeneous, actively digesting","Primary: contains DNA; Secondary: lacks enzymes","Primary: neutral pH; Secondary: alkaline","Primary: double membrane; Secondary: single membrane"],a:0,e:"Primary lysosomes have uniform dense appearance and have not engaged in digestion; secondary contain partially digested material and look heterogeneous.",add:"Secondary lysosomes form after fusion of endocytosed material with a primary lysosome.",w:["","DNA is not a defining feature.","Lysosomes function at acidic pH.","Both are single-membrane organelles."]},{q:"Heterophagy vs autophagy:",c:["Heterophagy digests material brought in by endocytosis; autophagy digests cell’s own components","Both refer only to bacterial digestion","Autophagy digests only extracellular matrix","Heterophagy is fusion with nucleus"],a:0,e:"Slides define heterophagy as digestion of endocytosed material and autophagy as turnover of intracellular components via fusion with primary lysosomes.",add:"Lysosomes are abundant in macrophages and other phagocytes.",w:["","Not in the slides.","Autophagy targets intracellular components, not ECM specifically.","Nucleus is not involved in heterophagy."]},{q:"Residual bodies / lipofuscin are common in:",c:["Long-lived cells like neurons and cardiac muscle","Hepatocytes exclusively","Erythrocytes","All rapidly dividing cells"],a:0,e:"Slides: residual bodies accumulate; large quantities called lipofuscin (age pigment) common in long-lived cells such as neurons and cardiac muscle.",add:"Residual bodies form when indigestible contents remain within lysosomes.",w:["","Not exclusive per slide.","Mature RBCs lack lysosomes.","Dividing cells dilute pigments; not highlighted as common here."]},{q:"Peroxisomes contain enzymes such as:",c:["Catalase, amino oxidases, hydroxy acid oxidase","Cytochrome c oxidase and ATP synthase","DNA polymerase and helicase","Pepsin and trypsin"],a:0,e:"Peroxisomes house catalase, amino oxidases, and hydroxy acid oxidase to decompose H2O2 and protect cells; they also participate in lipid metabolism.",add:"They resemble lysosomes in size but differ in enzyme composition.",w:["","Those are mitochondrial respiratory enzymes.","Nuclear DNA replication enzymes.","Digestive proteases of stomach/pancreas."]},{q:"The cytoskeleton listed components are:",c:["Microtubules, actin filaments, intermediate filaments","Actin filaments only","Myosin thick filaments only","Kinesin and dynein only"],a:0,e:"The cytoskeleton is composed of microtubules, microfilaments (actin), and intermediate filaments; provides form and movement.",add:"Motor proteins move along filaments/microtubules but are not themselves filaments.",w:["","Slides list three classes, not one.","Myosin is part of contractile apparatus but cytoskeleton includes more.","These are motors, not the filaments themselves."]},{q:"Microtubule structure:",c:["Hollow tubes of α/β-tubulin dimers with ~13 units per spiral turn","Solid rods of actin","Triple helical DNA fibers","Collagen fibrils"],a:0,e:"Slides: microtubules are like a straw—dense wall, hollow core; α/β-tubulin heterodimers in spirals with 13 units/turn.",add:"Polymerization directed by MTOCs: centrioles, basal bodies, centromeres.",w:["","That’s actin, not microtubules.","DNA is nuclear, not cytoskeletal filaments.","Extracellular matrix, not cytoskeleton."]},{q:"Within cells, vesicles/proteins move along tracks formed by:",c:["Microtubules with kinesin and dynein motors","Intermediate filaments with myosin motors","Actin filaments with dynein only","Golgi cisternae with clathrin motors"],a:0,e:"Slides: movement involves tracks of microtubules; motor proteins kinesin and dynein mediate this transport.",add:"Directionality isn’t detailed here, only that kinesin/dynein are involved.",w:["","Myosin is the actin motor; IFs are structural.","Dynein is a microtubule motor; actin uses myosin.","Clathrin forms coats; no such ‘motors’."]},{q:"Microtubule organizing centers (as listed):",c:["Centrioles, basal bodies, and centromeres","Only centrosomes","Ribosomes and nucleoli","Sarcomeres and desmosomes"],a:0,e:"Slides list centrioles, basal bodies, and centromeres directing polymerization.",add:"Terminology reflects the slide; focus on these exemplar MTOCs.",w:["","The slide spelled out specific structures.","These are for protein synthesis/RNA, not MT organizing.","Muscle/adhesion structures, not MT organizers."]},{q:"Centrioles are composed of:",c:["Nine microtubule triplets arranged in a pinwheel","Nine doublets plus two central singlets","Thirteen actin protofilaments","A single microtubule with dynein arms"],a:0,e:"Each centriole has 9 sets of microtubule triplets arranged in a pinwheel; pairs lie orthogonal near nucleus/Golgi.",add:"Basal bodies share essentially identical microtubule structure to centrioles.",w:["","That’s the axoneme (9+2) pattern.","That is actin’s description, not centrioles.","Dynein arms are axonemal, not centriole structure."]},{q:"Centriole dynamics in the cell cycle:",c:["Duplicate in S phase; pairs move to opposite poles during mitosis to organize spindles","Duplicate only in G1; remain near nucleus during mitosis","Disassemble before mitosis","Are absent from all human cells"],a:0,e:"Slides: during S period each centriole duplicates; during mitosis the two pairs move to opposite poles and organize the mitotic spindles.",add:"Orthogonal arrangement is typical in non-dividing cells.",w:["","Not per slide.","They organize the spindle; not stated to disassemble.","They are present; absence not stated here."]},{q:"Cilia vs flagella in humans:",c:["Both share a similar structure; flagella are found only in sperm","Cilia and flagella are structurally unrelated","Flagella are common on many epithelial cells","Only flagella beat; cilia are immotile by definition"],a:0,e:"Slides: cilia are motile processes; flagella share similar structure; in humans, flagella occur only in sperm.",add:"Both use an axoneme core.",w:["","They share the same core plan.","Not per slide.","Cilia are motile here."]},{q:"Axoneme core pattern:",c:["9 microtubule doublets around 2 central microtubules (9+2)","9 triplets with no central pair","13 protofilaments only","Random microtubule array"],a:0,e:"Axoneme consists of a circle of 9 pairs (doublets) with a central pair; linked by nexin and radial spokes; basal body resembles a centriole.",add:"Adjacent doublets are connected to central sheath via radial spokes.",w:["","That’s centriole/basal body pattern.","Protofilament count is a property of MT walls, not the axoneme arrangement.","The axoneme is highly ordered, not random."]},{q:"Mechanism driving ciliary/flagellar bending:",c:["Dynein arms on A-tubule ‘walk’ along B-tubule using ATPase activity","Kinesin sliding on actin filaments","Elastic recoil of intermediate filaments","Passive diffusion of tubulin"],a:0,e:"Dynein arms (ATPase) extend from the A microtubule and walk along the B of the adjacent doublet, producing sliding that bends the axoneme.",add:"This undulating motion accounts for ciliary/flagellar motility.",w:["","Kinesin transports cargo; actin uses myosin.","IFs provide structure, not motility.","Not a force-generating mechanism."]},{q:"Actin filament structure:",c:["Double-stranded helix of globular subunits; abundant in non-muscle cells too","Hollow tube of α/β-tubulin","Triple helix of DNA","Single collagen chain"],a:0,e:"Slides: actin forms thin filaments organized as a double-stranded helix; present in non-muscle cells and is the most abundant cytoskeletal protein.",add:"Cells often contain several actin isoforms/species.",w:["","That’s microtubules.","That’s chromatin.","Collagen is extracellular."]},{q:"Actin functions highlighted include:",c:["Anchorage of membrane proteins and core of microvilli; terminal web helps maintain apical shape","ATP generation in mitochondria","DNA repair in nucleus","H2O2 breakdown"],a:0,e:"Slides emphasize anchorage (e.g., focal adhesions) and formation of the structural core of microvilli; the apical terminal web acts as tension cables.",add:"Actin polymerization drives lamellipodia; depolymerization retracts the trailing edge.",w:["","Mitochondrial, not actin’s direct role.","Nuclear enzymes perform repair.","Peroxisomal function."]},{q:"Cell crawling (lamellipodia) depends on:",c:["Actin polymerization at the leading edge with trailing depolymerization","Dynein walking on microtubules","Intermediate filament sliding","Ribophorin-mediated translocation"],a:0,e:"Leading edge protrusion is driven by actin polymerization; trailing edge retracts as actin depolymerizes.",add:"Filopodia contain loose bundles of ~10–20 actin filaments oriented with plus ends toward the membrane.",w:["","Dynein is for MT-based motility, not lamellipodia.","IFs are structural; no stated motor.","Ribophorins are RER proteins."]},{q:"Intermediate filament key role:",c:["Structural reinforcement of cells and tissues","Vesicle transport motors","ATP synthesis","Protein glycosylation"],a:0,e:"Slides: the principal function of intermediate filaments is structural—reinforcing cells and organizing tissues.",add:"IF-associated proteins cross-link IFs into bundles (e.g., tonofilaments), networks, or to membranes.",w:["","Transport is microtubule/actin-motor based.","Mitochondrial job.","Golgi/ER job."]},{q:"Which intermediate filament pairing is correct?",c:["Cytokeratins – epithelial cells","Vimentin – neurons","Desmin – hepatocytes","GFAP – skeletal muscle"],a:0,e:"Types: cytokeratins in epithelium; vimentin in mesenchymal/embryonic cells; desmin in muscle; GFAP in astrocytes; neurofilaments in neurons; nuclear lamins line inner nuclear envelope of all cells.",add:"These patterns are used diagnostically.",w:["","Neurons contain neurofilaments; vimentin is mesenchymal.","Desmin is in smooth, cardiac, and skeletal muscle.","GFAP marks astrocytes (glia)."]}];const $=id=>document.getElementById(id),qEl=$("question"),choicesEl=$("choices"),explEl=$("explanation"),addEl=$("additional"),nextBtn=$("next-btn"),prevBtn=$("prev-btn"),resetBtn=$("reset-btn"),openBtn=$("open-tab-btn"),saveBtn=$("save-btn"),menuBtn=$("review-menu-btn"),menu=$("review-menu"),listEl=$("review-list");const sWrap=$("search-wrap"),sInput=$("search-input"),sList=$("search-results");const importBtn=$("import-btn"),importMenu=$("import-menu"),importTA=$("import-ta"),importStatus=$("import-status"),importJSON=$("import-json-file"),importLoad=$("import-load-json");const instrBtn=document.getElementById('instr-btn'),instrPanel=document.getElementById('instr-panel'),instrTA=document.getElementById('instr-ta'),instrCopy=document.getElementById('instr-copy');const read=(k,d={})=>{try{const v=localStorage.getItem(k);return v?JSON.parse(v):d}catch(e){return d}},write=(k,v)=>{try{localStorage.setItem(k,JSON.stringify(v))}catch(e){}};const STORAGE_KEY='histologyL2QuizStateV1',PROG_KEY=STORAGE_KEY+'_progress',BM_KEY=STORAGE_KEY+'_bookmarks';function updateTitle(){const h=document.querySelector('h1');if(h)h.textContent='Quiz Review';document.title='Quiz Review'}function ensureVisible(el){try{if(!el||el.style.display!=='block')return;const r=el.getBoundingClientRect();let dx=0;if(r.right>window.innerWidth)dx=r.right-window.innerWidth+12;if(r.left<0)dx=r.left-12;if(dx)window.scrollBy({left:dx,behavior:'smooth'})}catch(e){}}function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]}}function saveState(){write(STORAGE_KEY,{order,current,queued:[...queued],choiceMap,attemptMap})}function loadState(){const s=read(STORAGE_KEY,null);return s&&Array.isArray(s.order)&&typeof s.current==='number'?s:null}let order=[],current=0,queued=new Set(),choiceMap={},attemptMap={};function enforceCap(){try{if(questions.length>100)questions.splice(100);if(typeof order!=='undefined'){order=order.filter(i=>i<questions.length);if(current>=order.length)current=Math.max(0,order.length-1)}}catch(e){}}function getChoiceOrder(i){if(!choiceMap[i]){choiceMap[i]=[0,1,2,3];shuffle(choiceMap[i]);saveState()}return choiceMap[i]}(function init(){const s=loadState();if(s){order=s.order.filter(i=>Number.isInteger(i)&&i>=0&&i<questions.length);current=Math.min(Math.max(0,s.current),order.length);queued=new Set((s.queued||[]).filter(i=>Number.isInteger(i)&&i>=0&&i<questions.length));choiceMap=s.choiceMap||{};attemptMap=s.attemptMap||{};if(order.length===0){order=[...Array(questions.length).keys()];shuffle(order);current=0}}else{order=[...Array(questions.length).keys()];shuffle(order);current=0}saveState()})();function buildWrongsList(item,orderArr){if(!item.w)return'';const list=orderArr.map(o=>o!==item.a?`<li><strong>${item.c[o]}:</strong> ${item.w[o]||''}</li>`:'').filter(Boolean).join('');return list?`<div style="margin-top:.75rem"><div style="font-weight:700;margin-bottom:.25rem">Why the other options are wrong:</div><ul style="margin:0 0 0 1.25rem;padding:0;list-style:disc">${list}</ul></div>`:''}function finalizeQuestion(orderArr,item){[...choicesEl.children].forEach(b=>b.disabled=true);addEl.innerHTML=item.add||'';addEl.style.display=item.add?'block':'none';explEl.innerHTML=item.e+buildWrongsList(item,orderArr);explEl.style.display='block';nextBtn.style.display='inline-block';saveState()}function showQuestion(){if(current>=order.length){qEl.textContent='Quiz complete!';choicesEl.innerHTML='';explEl.style.display='none';addEl.style.display='none';nextBtn.style.display='none';try{localStorage.removeItem(STORAGE_KEY)}catch(e){}return}const qi=order[current],it=questions[qi],co=getChoiceOrder(qi);const n=Math.min(questions.length,100);qEl.innerHTML=`<span class="qhead"><select id="jump-select" title="Jump to question"></select></span> ${it.q}`;(function(){const js=document.getElementById('jump-select');if(!js)return;js.innerHTML='';for(let pos=0;pos<n;pos++){const qx=order[pos],t=(questions[qx]&&questions[qx].q)||('Question '+(qx+1));const o=document.createElement('option');o.value=pos;o.textContent='Q '+(pos+1);o.title=t;if(pos===current)o.selected=true;js.appendChild(o)}js.addEventListener('focus',()=>ensureVisible(js));js.addEventListener('mousedown',()=>ensureVisible(js));js.onchange=e=>{current=parseInt(e.target.value,10)||0;saveState();showQuestion()}})();choicesEl.innerHTML='';explEl.style.display='none';addEl.style.display='none';nextBtn.style.display='inline-block';co.forEach((orig,di)=>{const b=document.createElement('button');b.className='choice';b.innerHTML=`<span class="label">${['A','B','C','D'][di]}.</span> ${it.c[orig]}`;b.onclick=()=>selectAnswer(b,di,qi);choicesEl.appendChild(b)});restoreUI(qi);nextBtn.style.display='inline-block';updateSaveBtn();prevBtn.style.display=current>0?'inline-block':'none'}function selectAnswer(btn,di,qi){const it=questions[qi],co=getChoiceOrder(qi),chosen=co[di],attempts=attemptMap[qi]||0;if(chosen===it.a){btn.classList.add('correct');finalizeQuestion(co,it);attemptMap[qi]=(attempts+1);captureUI(qi);return}if(attempts===0){btn.classList.add('incorrect');btn.disabled=true;explEl.innerHTML='<div style="opacity:.9">One more try — choose the best remaining option.</div>';explEl.style.display='block';nextBtn.style.display='inline-block';attemptMap[qi]=1;captureUI(qi);return}else{btn.classList.add('incorrect');const bs=[...choicesEl.children];bs.forEach(b=>b.disabled=true);const ci=co.indexOf(it.a);if(ci>-1)bs[ci].classList.add('correct');addEl.innerHTML=it.add||'';addEl.style.display=it.add?'block':'none';explEl.innerHTML=it.e+buildWrongsList(it,co);explEl.style.display='block';nextBtn.style.display='inline-block';attemptMap[qi]=attempts+1;if(!queued.has(qi)){queued.add(qi);order.push(qi)}captureUI(qi);return}}function captureUI(qi){const btns=[...choicesEl.children];write(PROG_KEY,{...read(PROG_KEY),[qi]:{disabled:btns.map(b=>!!b.disabled),classes:btns.map(b=>b.className),explHTML:explEl.innerHTML,explVisible:explEl.style.display!=='none',addHTML:addEl.innerHTML,addVisible:addEl.style.display!=='none',nextVisible:nextBtn.style.display!=='none',attempts:attemptMap[qi]||0}})}function restoreUI(qi){const s=read(PROG_KEY)[qi];if(!s)return;if(s.attempts!=null)attemptMap[qi]=s.attempts;const btns=[...choicesEl.children];(s.classes||[]).forEach((c,i)=>{if(btns[i])btns[i].className=c});(s.disabled||[]).forEach((d,i)=>{if(btns[i])btns[i].disabled=!!d});explEl.innerHTML=s.explHTML||'';explEl.style.display=s.explVisible?'block':'none';addEl.innerHTML=s.addHTML||'';addEl.style.display=s.addVisible?'block':'none';nextBtn.style.display=s.nextVisible?'inline-block':'none'}nextBtn.onclick=()=>{captureUI(order[current]);current++;try{const tgt=order[current];if(tgt!=null){const prog=read(PROG_KEY);if(prog&&prog[tgt]){delete prog[tgt];write(PROG_KEY,prog)}if(attemptMap)delete attemptMap[tgt]}}catch(e){};saveState();showQuestion()};prevBtn.onclick=()=>{if(current>0){captureUI(order[current]);current--;saveState();showQuestion()}};resetBtn.onclick=()=>{try{localStorage.removeItem(STORAGE_KEY)}catch(e){}order=[...Array(questions.length).keys()];shuffle(order);current=0;queued=new Set();choiceMap={};attemptMap={};write(PROG_KEY,{});saveState();showQuestion()};openBtn.onclick=()=>{try{const html='<!DOCTYPE html>'+document.documentElement.outerHTML;const url=URL.createObjectURL(new Blob([html],{type:'text/html'}));window.open(url,'_blank','noopener,noreferrer')}catch(e){window.open(location.href,'_blank','noopener,noreferrer')}};function loadBM(){return read(BM_KEY)}function saveBM(m){write(BM_KEY,m)}function isSaved(qi){return Object.prototype.hasOwnProperty.call(loadBM(),String(qi))}function updateSaveBtn(){const qi=order[current];if(isSaved(qi)){saveBtn.classList.add('saved');saveBtn.textContent='★ Saved'}else{saveBtn.classList.remove('saved');saveBtn.textContent='☆ Save'}}saveBtn.onclick=()=>{const qi=order[current],m=loadBM();if(isSaved(qi))delete m[String(qi)];else m[String(qi)]=Date.now();saveBM(m);renderMenu();updateSaveBtn()};function renderMenu(){const m=loadBM(),entries=Object.keys(m).map(k=>({qi:parseInt(k,10),ts:m[k]})).sort((a,b)=>b.ts-a.ts);menuBtn.textContent='Saved ('+entries.length+')';listEl.innerHTML=entries.length?'':'<li class="rev-meta" style="padding:.5rem .5rem">No saved questions yet.</li>';entries.forEach(({qi})=>{const li=document.createElement('li'),jump=document.createElement('button');jump.className='rev-jump';const pos=order.indexOf(qi),title=(questions[qi]&&questions[qi].q)||('Question '+(qi+1));jump.textContent=(pos>=0?('Q'+(pos+1)+': '):'Q? ')+title;jump.onclick=()=>{const idx=order.indexOf(qi);if(idx>=0){try{const prog=read(PROG_KEY);if(prog&&prog[qi]!=null){delete prog[qi];write(PROG_KEY,prog)}if(attemptMap)delete attemptMap[qi]}catch(e){}current=idx;saveState();showQuestion();}};const rm=document.createElement('button');rm.className='rev-remove';rm.textContent='×';rm.title='Remove';rm.onclick=()=>{const mm=loadBM();delete mm[String(qi)];saveBM(mm);renderMenu();updateSaveBtn()};li.appendChild(jump);li.appendChild(rm);listEl.appendChild(li)})}menuBtn.onclick=e=>{e.stopPropagation();menu.style.display=menu.style.display==='block'?'none':'block';if(menu.style.display==='block')ensureVisible(menu)};document.addEventListener('click',e=>{if(sWrap&&!sWrap.contains(e.target))sList.style.display='none';if(menu&&e.target!==menu&&!menu.contains(e.target)&&e.target!==menuBtn)menu.style.display='none';if(importMenu&&e.target!==importMenu&&!importMenu.contains(e.target)&&e.target!==importBtn)importMenu.style.display='none'});document.addEventListener('click',e=>{if(instrPanel&&e.target!==instrPanel&&!instrPanel.contains(e.target)&&e.target!==instrBtn)instrPanel.style.display='none'});(function(){if(instrTA)instrTA.value="Generate up to 100 multiple-choice questions as a valid JSON array with this schema: [{\"q\":\"Question text\",\"c\":[\"Choice A\",\"Choice B\",\"Choice C\",\"Choice D\"],\"a\":0,\"e\":\"Why the correct answer is correct\",\"add\":\"(optional)\",\"w\":[\"\",\"Why B is wrong\",\"Why C is wrong\",\"Why D is wrong\"]}]. Use only my slides; exactly 4 choices; 'a' is 0–3 for the correct option; no trailing commas; return only downloadable JSON.";if(instrBtn)instrBtn.onclick=(ev)=>{ev.stopPropagation();instrPanel.style.display=instrPanel.style.display==='block'?'none':'block'};if(instrCopy)instrCopy.onclick=async()=>{try{await navigator.clipboard.writeText(instrTA.value);instrCopy.textContent='Copied!';setTimeout(()=>instrCopy.textContent='Copy',1000)}catch(e){}}})();function importToggle(){if(importMenu){importMenu.style.display=importMenu.style.display==='block'?'none':'block';if(importMenu.style.display==='block')ensureVisible(importMenu)}}if(importBtn){importBtn.onclick=e=>{e.stopPropagation();importToggle()}}function parseImported(t){try{const a=JSON.parse(t);if(Array.isArray(a))return a}catch(e){}return null}function validateQs(a){return Array.isArray(a)&&a.every(q=>q&&typeof q.q==='string'&&Array.isArray(q.c)&&q.c.length===4&&Number.isInteger(q.a))}if(importLoad){importLoad.onclick=()=>{try{if(!importJSON||!importJSON.files||!importJSON.files[0]){if(importStatus)importStatus.textContent='Choose a JSON file.';return}const r=new FileReader();r.onload=()=>{try{const arr=JSON.parse((r.result||'').trim());if(!validateQs(arr)){if(importStatus)importStatus.textContent='Invalid JSON array.';return}questions.splice(0,questions.length,...arr);try{localStorage.removeItem(STORAGE_KEY)}catch(e){}write(PROG_KEY,{});write(BM_KEY,{});order=[...Array(questions.length).keys()];shuffle(order);current=0;queued=new Set();choiceMap={};attemptMap={};enforceCap();saveState();showQuestion();renderMenu();updateSaveBtn();updateTitle();if(importStatus)importStatus.textContent='Loaded '+arr.length+' questions.'}catch(e){if(importStatus)importStatus.textContent='Load error: '+e}};r.onerror=()=>{if(importStatus)importStatus.textContent='Read failed'};r.readAsText(importJSON.files[0])}catch(e){if(importStatus)importStatus.textContent='Load error: '+e}}}function norm(t){return (t||'').toLowerCase()}function doSearch(q){if(!sList)return;sList.innerHTML='';q=(q||'').trim();if(q.length<2){sList.style.display='none';return}const n=Math.min(questions.length,100),needle=norm(q),res=[];for(let i=0;i<n;i++){const it=questions[i]||{},hay=[it.q,(it.c||[]).join(' '),it.e,it.add].map(norm).join(' ');if(hay.indexOf(needle)>-1){res.push(i);if(res.length>=12)break}}if(!res.length){sList.style.display='none';return}res.forEach(i=>{const li=document.createElement('li'),pos=order.indexOf(i),label=(pos>=0?(pos+1)+'/'+Math.min(questions.length,100)+': ':'')+((questions[i]&&questions[i].q)||('Question '+(i+1)));li.textContent=label;li.onclick=()=>{const idx=order.indexOf(i);if(idx>=0){current=idx;saveState();showQuestion()}sList.style.display='none';sInput&&sInput.blur()};sList.appendChild(li)});sList.style.display='block'}if(sInput){sInput.addEventListener('input',e=>doSearch(e.target.value));sInput.addEventListener('focus',e=>doSearch(e.target.value))}enforceCap();showQuestion();renderMenu();updateSaveBtn();updateTitle();try{console.assert(typeof write==='function','write helper exists');console.assert(Array.isArray(questions)&&questions.length>0,'questions seeded');const t=buildWrongsList({w:["",'x','y','z'],c:['a','b','c','d'],a:0},[0,1,2,3]);console.assert(t.includes('<li>'),'wrongs list renders');console.debug('[Quiz Self-Tests] OK')}catch(err){console.warn('[Quiz Self-Tests]',err)}</script><script>
(function(){
  const area = document.getElementById('work-area');
  const btn = document.getElementById('viewer-toggle-btn');
  const resetBtn = document.getElementById('reset-layout-btn');
  const quiz = document.getElementById('quiz-card');
  const pane = document.getElementById('pdf-pane');
  const iframe = document.getElementById('pdf-iframe');
 
  if(btn){
    btn.addEventListener('click', ()=>{
      const open = area.classList.toggle('viewer-open');
      btn.textContent = open ? 'Hide Lecture Viewer' : 'Show Lecture Viewer';
    });
  }
 
  function ensureFixed(el){
    // Convert current location into fixed positioning so it can be dragged
    const r = el.getBoundingClientRect();
    el.style.position = 'fixed';
    el.style.top = Math.max(8, r.top) + 'px';
    el.style.left = Math.max(8, r.left) + 'px';
    el.style.width = r.width + 'px';
    // Keep current height to avoid content jumps; pdf pane needs a height
    if(el.id === 'pdf-pane'){
      el.style.height = r.height + 'px';
    }
  }
  function unfix(el){
    el.style.position = '';
    el.style.top = el.style.left = el.style.width = el.style.height = '';
  }
 
  function isInteractive(target){
    return !!(target.closest('button,input,select,textarea,a,summary,label,iframe,#review-menu,#import-menu,#resources-panel,#search-results,#jump-select,.choice'));
  }
 
  function makeDraggable(el){
    let dragging = false, startX = 0, startY = 0, baseLeft = 0, baseTop = 0;
    let blockedIframe = null;
    let prevResize = '';
 
    el.addEventListener('mousedown', (e)=>{
      // Start drag if user clicks within the gray card/pane area (not on interactive controls)
      if(e.button !== 0) return; // left button only
      if(isInteractive(e.target)) return;
      // If the click is inside a nested element, still allow drag as long as it's not interactive
      ensureFixed(el);
      dragging = true;
      startX = e.clientX;
      startY = e.clientY;
      // Lock current size so dragging doesn't trigger resizing
      prevResize = el.style.resize;
      el.style.resize = 'none';
      const r = el.getBoundingClientRect();
      baseLeft = r.left;
      baseTop = r.top;
      // Temporarily disable iframe pointer events so drag is smooth
      if(el.id === 'pdf-pane'){
        const ifr = el.querySelector('iframe');
        if(ifr){
          blockedIframe = ifr;
          ifr.style.pointerEvents = 'none';
        }
      }
      e.preventDefault();
    });
 
    window.addEventListener('mousemove', (e)=>{
      if(!dragging) return;
      const dx = e.clientX - startX;
      const dy = e.clientY - startY;
      el.style.left = (baseLeft + dx) + 'px';
      el.style.top  = (baseTop + dy) + 'px';
    });
 
    window.addEventListener('mouseup', ()=>{
      if(!dragging) return;
      dragging = false;
      if(blockedIframe){
        blockedIframe.style.pointerEvents = '';
        blockedIframe = null;
      }
      // Restore previous resize behaviour after dragging ends
      el.style.resize = prevResize;
    });
  }
 
  // Enable dragging on both panels whenever they are visible
  if(quiz) makeDraggable(quiz);
  if(pane) makeDraggable(pane);
 
  if(resetBtn){
    resetBtn.addEventListener('click', ()=>{
      // Clear any manual positioning and restore default layout
      [quiz,pane].forEach(el=>{ if(el){ unfix(el); } });
      area.classList.add('viewer-open'); // keep viewer visible after reset
      window.scrollTo(0,0);
    });
  }
 
  // Clicking a lecture loads its viewer page into the iframe
  document.querySelectorAll('#resources-list a[data-view]').forEach(a=>{
    a.addEventListener('click', (ev)=>{
      ev.preventDefault();
      const url = a.getAttribute('data-view') || 'about:blank';
      if(!area.classList.contains('viewer-open')){
        area.classList.add('viewer-open');
        if(btn) btn.textContent = 'Hide Lecture Viewer';
      }
      iframe.src = url;
      const t = a.querySelector('.resources-title')?.textContent || 'Lecture Viewer';
      const title = document.getElementById('pdf-title');
      if(title) title.textContent = t;
    });
  });
})();
</script></body></html>
 
